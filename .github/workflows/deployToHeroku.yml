name: Deploy App

on:
  push:
    branches: [ main ]

  workflow_dispatch:

jobs:

  deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Run Gradle Tests
        run: ./gradlew clean test
        
      - name: Deploy Docker Image to Heroku App
        # You may pin to the exact commit or the version.
        # uses: jctaveras/heroku-deploy@66bad8e81927dbf4a39ef8364a4c2f3043233ce0
        uses: jctaveras/heroku-deploy@v2.1.3
        with:
          # Email Linked to your Heroku Account
          email: gamebreak24@gmail.com
          # Your Heroku API Key
          api_key: a20208e3-0e93-40c3-9cb1-4570aeda19e3
          # Your Heroku App Name
          app_name: vegan-info
          # Dokerfile path
          dockerfile_path: .
